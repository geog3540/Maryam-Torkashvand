<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>migrationstructures</title>

  <!-- Bootstrap CSS -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://d3js.org/d3.v6.min.js"></script>

  <style>
  /* Remove the navbar's default margin-bottom and rounded borders */
  .navbar {
    background-color: #14365D;
  }

  /* Add a gray background color and some padding to the footer */
  footer {
    background-color: #f2f2f2;
    padding: 25px;
  }

  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
  }

  .map-container {
    position: relative;
    display: inline-block;
    margin: 10px;
  }

  .compare-btn {
    position: absolute;
    bottom: 10px;
    right: 10px;
    z-index: 10;
  }
  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark custom-navbar fixed-top">
    <div class="container">
      <a class="navbar-brand" href="#">Maryam Torkashvand Portfolio</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item active">
            <a class="nav-link" href="#">Home
              <span class="sr-only">(current)</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="shortbio.html">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="files/Torkashvand_CV_March-2023.pdf">My C.V.</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="mailto:maryam-torkashvand@uiowa.edu">Contact</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container">
    <h1>Migration Structures in the United States (1910-1920)</h1>
  </div>
  <div class="container text-center">
    <p>Mapping migration regions using two network community detection algorithms. The visualization method employed ensures consistency by maintaining the same color for each region across both maps, allowing for easier comparison and interpretation</p>
  </div>

  <div class="row">
    <div id="mapGrid" class="row">
      <!-- Maps will be appended here -->
    </div>
  </div>
</div>
<script>

function pairCountingSimilarity(communities1, communities2) {
  if (communities1.length !== communities2.length) {
    throw new Error("Input arrays must have the same length");
  }

  //initialize the variables
  let matches = 0;
  let totalPairs = 0;

  //define the unique pairs of nodes (0,1),(0,2), ... (n-1,n)
  for (let i = 0; i < communities1.length; i++) {
    for (let j = i + 1; j < communities1.length; j++) {
      totalPairs++;

      //chech whether those pairs that are in a same community in network 1 also are the same community in network 2
      //if true, add 1 to the match variable
      if (communities1[i] === communities1[j] && communities2[i] === communities2[j]) {
        matches++;
      }
    }
  }
}

  //////////////////////////////////////////////////////////////////////////////////
  function drawMap(mapId, geoJsonData, partitionAttribute, colorScale) {
    const width = 400;
    const height = 310;
    const projection = d3.geoAlbersUsa().scale(400).translate([width / 2, height / 2]);
    const path = d3.geoPath().projection(projection);

    const svg = d3.select("#" + mapId)
    .append("svg")
    .attr("width", width)
    .attr("height", height);

    svg.selectAll("path")
    .data(geoJsonData.features)
    .join("path")
    .attr("d", path)
    .attr("fill", d => colorScale(d.properties[partitionAttribute]))
    .attr("stroke", "white")
    .attr("stroke-width", 1);
  }

  const colorScale = d3.scaleOrdinal(d3.schemeCategory10);

  // List of GeoJSON file paths
  const mapFiles = [
    "data/louvain.geojson", "data/leiden.geojson"
  ];

  const mapGrid = document.getElementById("mapGrid");

  for (let i = 0; i < mapFiles.length; i++) {
    const mapId = "map" + i;
    const mapContainer = d3.select("#mapGrid")
    .append("div")
    .attr("class", "col-md-4 map-container");

    mapContainer.append("div")
    .attr("id", mapId)
    .attr("class", "map");

    // Create a dropdown menu
    const dropdown = mapContainer.append("select")
    .attr("class", "form-control compare-dropdown")

    // Add options to the dropdown menu
    for (let j = 0; j < mapFiles.length; j++) {
      if (j !== i) {
        dropdown.append("option")
        .attr("value", j)
        .text("Compare with Map " + (j + 1));
      }
    }

    // Add a change event listener to the dropdown menu
    dropdown.on("change", function () {
      const selectedMapIndex = parseInt(this.value);
      // Add your compare functionality here
      console.log(`Comparing map ${i + 1} with map ${selectedMapIndex + 1}`);
    });

    d3.json(mapFiles[i]).then(geoJsonData => {
      const partitionAttribute = i < 5 ? "leidenpart" : "louvainpar";
      drawMap(mapId, geoJsonData, partitionAttribute, colorScale);
    });
  }
</script>
</body>
</html>
